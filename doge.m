SS = 0; % scalescale (flag)
DS = 1; % detailscale (flag)
SD = 2; % scaledetail (flag)
DD = 3; % detaildetail (flag)

DOGE = [0.002721
    0.002724
    0.002695
    0.002619
    0.002646
    0.002671
    0.002649
    0.002623
    0.002475
    0.002425
    0.002356
    0.002384
    0.002415
    0.002869
    0.003261
    0.004314
    0.00395
    0.003836
    0.003531
    0.003582
    0.003638
    0.003668
    0.00366
    0.003645
    0.003461
    0.00347
    0.003477
    0.003352
    0.003325
    0.00316
    0.003163
    0.002969
    0.002965
    0.002915
    0.002909
    0.002827
    0.002669
    0.002593
    0.002609
    0.00246
    0.00244
    0.002451
    0.002325
    0.002412
    0.00237
    0.002478
    0.002499
    0.002473
    0.002485
    0.002431
    0.002517
    0.002397
    0.002436
    0.002439
    0.002413
    0.002468
    0.002619
    0.00262
    0.003269
    0.004849
    0.006753
    0.006554
    0.00555
    0.005323
    0.005394
    0.005092
    0.005442
    0.005858
    0.005843
    0.006933
    0.006931
    0.006457
    0.006609
    0.006658
    0.006267
    0.006531
    0.006547
    0.00628
    0.006031
    0.0059
    0.005961
    0.005817
    0.005907
    0.006067
    0.005794
    0.005753
    0.00591
    0.005965
    0.005898
    0.00591
    0.006024
    0.005964
    0.005826
    0.005767
    0.005744
    0.00577
    0.005575
    0.005652
    0.005639
    0.005648
    0.005547
    0.005283
    0.005272
    0.005223
    0.005457
    0.005222
    0.005025
    0.004729
    0.004566
    0.004558
    0.004602
    0.004535
    0.004401
    0.004163
    0.003921
    0.003984
    0.004256
    0.004188
    0.004064
    0.003908
    0.003873
    0.003951
    0.00381
    0.003786
    0.003788
    0.003744
    0.003732
    0.003719
    0.00366
    0.003373
    0.003347
    0.003286
    0.003173
    0.003087
    0.002954
    0.002816
    0.002819
    0.002771
    0.002645
    0.002717
    0.002437
    0.002505
    0.002481
    0.002419
    0.00239
    0.002262
    0.002254
    0.002106
    0.002302
    0.002277
    0.002255
    0.002279
    0.002271
    0.002386
    0.002379
    0.002258
    0.002227
    0.002139
    0.002157
    0.002144
    0.002119
    0.002101
    0.002137
    0.002119
    0.002085
    0.002121
    0.002145
    0.002716
    0.00269
    0.002771
    0.002779
    0.002745
    0.002561
    0.002589
    0.002638
    0.002555
    0.002496
    0.002486
    0.002447
    0.002446
    0.002402
    0.002395
    0.002392
    0.002458
    0.002414
    0.002397
    0.00235
    0.002371
    0.002335
    0.002321
    0.002307
    0.002295
    0.002149
    0.002158
    0.002171
    0.002198
    0.002188
    0.002141
    0.002147
    0.002117
    0.00216
    0.002153
    0.002122
    0.002112
    0.002068
    0.002073
    0.002183
    0.002152
    0.002096
    0.002028
    0.00197
    0.00197
    0.001987
    0.001928
    0.001956
    0.001957
    0.001932
    0.001913
    0.001902
    0.00189
    0.001957
    0.001996
    0.001953
    0.001946
    0.001911
    0.00191
    0.001909
    0.001915
    0.001929
    0.001993
    0.002124
    0.002139
    0.002081
    0.002078
    0.002071
    0.002111
    0.002125
    0.002045
    0.00205
    0.002033
    0.002024
    0.00202
    0.002013
    0.002024
    0.002011
    0.002003
    0.001992
    0.002015
    0.001998
    0.002015
    0.002004
    0.002006
    0.00203
    0.002053
    0.002044
    0.002058
    0.002099
    0.00209
    0.002094
    0.002106
    0.002092
    0.002074
    0.002074
    0.00208
    0.00208
    0.002066
    0.002061
    0.002089
    0.002092
    0.002102
    0.002166
    0.0021
    0.002532
    0.002863
    0.003656
    0.004096
    0.003755
    0.003594
    0.003517
    0.003437
    0.00307
    0.00308
    0.003031
    0.002873
    0.002906
    0.002903
    0.002923
    0.002856
    0.002861
    0.002958
    0.002948
    0.002903
    0.002906
    0.002824
    0.002856
    0.002779
    0.00262
    0.002526
    0.002545
    0.002563
    0.002551
    0.002519
    0.002551
    0.002656
    0.002753
    0.002783
    0.002709
    0.002661
    0.002632
    0.002572
    0.002554
    0.002559
    0.002799
    0.00282
    0.002823
    0.003199
    0.003317
    0.003521
    0.003186
    0.003054
    0.003195
    0.003186
    0.003112
    0.003091
    0.00298
    0.003022
    0.003011
    0.003115
    0.003207
    0.003168
    0.003151
    0.0036
    0.003443
    0.00352
    0.003448
    0.00341
    0.003213
    0.003098
    0.003124
    0.003195
    0.003191
    0.003218
    0.003135
    0.003143
    0.003094
    0.003168
    0.003142
    0.003204
    0.003336
    0.003225
    0.003199
    0.003154
    0.003204
    0.003251
    0.003354
    0.003496
    0.003431
    0.003395
    0.00345
    0.003495
    0.003523
    0.003486
    0.003446
    0.003325
    0.00336
    0.003336
    0.003357
    0.004471
    0.003968
    0.003658
    0.003644
    0.003615
    0.0036
    0.003426
    0.003368
    0.003351
    0.003259
    0.003133
    0.003125
    0.003177
    0.003145
    0.003135
    0.003187
    0.003166
    0.0031
    0.003003
    0.002917
    0.003018
    0.002949
    0.00303
    0.002887
    0.002897
    0.002888
    0.002908
    0.002959
    0.002975
    0.00296
    0.002984
    0.003162
    0.003316
    0.00305
    0.003012
    0.002933
    0.002929
    0.002902
    0.002901
    0.00289
    0.00283
    0.002753
    0.002714
    0.00269
    0.00273
    0.002827
    0.002807
    0.00277
    0.002731
    0.002899
    0.002725
    0.002888
    0.002829
    0.002788
    0.002633
    0.002524
    0.002487
    0.002529
    0.002533
    0.002616
    0.002724
    0.002695
    0.002692
    0.00264
    0.002569
    0.00256
    0.00251
    0.002489
    0.002451
    0.002446
    0.002432
    0.002451
    0.002486
    0.002491
    0.002615
    0.002993
    0.002734
    0.002716
    0.002672
    0.002609
    0.0026
    0.002502
    0.002243
    0.002229
    0.002228
    0.002248
    0.002336
    0.002416
    0.002497
    0.002411
    0.002365
    0.002363
    0.002377
    0.002362
    0.002408
    0.002418
    0.002402
    0.0024
    0.002383
    0.002383
    0.002618
    0.002636
    0.002565
    0.002619
    0.002932
    0.002863
    0.002795
    0.002775
    0.002813
    0.002776
    0.002587
    0.002553
    0.002714
    0.002858
    0.002747
    0.002722
    0.002728
    0.002682
    0.002675
    0.002639
    0.002651
    0.002674
    0.002645
    0.002651
    0.00265
    0.002734
    0.002731
    0.002742
    0.002785
    0.00278
    0.002735
    0.002725
    0.002698
    0.002689
    0.002675
    0.002718
    0.002715
    0.002608
    0.002698
    0.002566
    0.002519
    0.002507
    0.00251
    0.002369
    0.002342
    0.002358
    0.00238
    0.002458
    0.002474
    0.002394
    0.002312
    0.002256
    0.002241
    0.002305
    0.00228
    0.002248
    0.002341
    0.002251
    0.002222
    0.00224
    0.002198
    0.002208
    0.002204
    0.002171
    0.002184
    0.002152
    0.002192
    0.002199
    0.002141
    0.002088
    0.00212
    0.002137
    0.002114
    0.002098
    0.002098
    0.002075
    0.00209
    0.002114
    0.002077
    0.002056
    0.002052
    0.00211
    0.002177
    0.00249
    0.002491
    0.002564
    0.002497
    0.002465
    0.002314
    0.002361
    0.002373
    0.002413
    0.002407
    0.002514
    0.002541
    0.002424
    0.002516
    0.002538
    0.00257
    0.002423
    0.002403
    0.002399
    0.002358
    0.002293
    0.002276
    0.002307
    0.002413
    0.00245
    0.002471
    0.002446
    0.002458
    0.002431
    0.002506
    0.002517
    0.002503
    0.00263
    0.002677
    0.00277
    0.003209
    0.003531
    0.003303
    0.003085
    0.003173
    0.003216
    0.003147
    0.003181
    0.002965
    0.002772
    0.002846
    0.002874
    0.002673
    0.002703
    0.002655
    0.002682
    0.002687
    0.002591
    0.002487
    0.002403
    0.002373
    0.00232
    0.002297
    0.00237
    0.002525
    0.002508
    0.002531
    0.002517
    0.002513
    0.002408
    0.002236
    0.002263
    0.002228
    0.002188
    0.001799
    0.001784
    0.001819
    0.001699
    0.001677
    0.001612
    0.001844
    0.001931
    0.001851
    0.001868
    0.001817
    0.001912
    0.00189
    0.001872
    0.001868
    0.001808
    0.001805
    0.001868
    0.001851
    0.001867
    0.00194
    0.001916
    0.00191
    0.001909
    0.001983
    0.00203
    0.002044
    0.002033
    0.002023
    0.002004
    0.002009
    0.00199
    0.00198
    0.001975
    0.002029
    0.002029
    0.002062
    0.002073
    0.002066
    0.002032
    0.002033
    0.002123
    0.002121
    0.002146
    0.002444
    0.002414
    0.002372
    0.002542
    0.002689
    0.002559
    0.002553
    0.002583
    0.002519
    0.002521
    0.002583
    0.002678
    0.002672
    0.002634
    0.002613
    0.002512
    0.002513
    0.002528
    0.002623
    0.002577
    0.002534
    0.002578
    0.002587
    0.002565
    0.002563
    0.002549
    0.002543
    0.002565
    0.002561
    0.002546
    0.002542
    0.002529
    0.002559
    0.002549
    0.002626
    0.002617
    0.002662
    0.002655
    0.002598
    0.002669
    0.002634
    0.002606
    0.002609
    0.002607
    0.002587
    0.002595
    0.002602
    0.002533
    0.002541
    0.002554
    0.002516
    0.00253
    0.002492
    0.002493
    0.002472
    0.002466
    0.002478
    0.002495
    0.002492
    0.002497
    0.002433
    0.002427
    0.002379
    0.002361
    0.002341
    0.00234
    0.002376
    0.002382
    0.002366
    0.00234
    0.002327
    0.002624
    0.003259
    0.00542
    0.005014
    0.004394
    0.00392
    0.003844
    0.003636
    0.003369
    0.003303
    0.003098
    0.003084
    0.003629
    0.003753
    0.003433
    0.003309
    0.003304
    0.003321
    0.003323
    0.003295
    0.00327
    0.003243
    0.003219
    0.003262
    0.003244
    0.00324
    0.003797
    0.003736
    0.003441
    0.003561
    0.003577
    0.003636
    0.003611
    0.003536
    0.003533
    0.003557
    0.003571
    0.003534
    0.003549
    0.003579
    0.003607
    0.003552
    0.003718
    0.003709
    0.003538
    0.003499
    0.003554
    0.003447
    0.003453
    0.003465
    0.003434
    0.003345
    0.003314
    0.003271
    0.003301
    0.003344
    0.003308
    0.003281
    0.003266
    0.003134
    0.002958
    0.002934
    0.002814
    0.002832
    0.002834
    0.002807
    0.002859
    0.002825
    0.002831
    0.002824
    0.002843
    0.002878
    0.002859
    0.002859
    0.002825
    0.002814
    0.002806
    0.002802
    0.002672
    0.002675
    0.00266
    0.002719
    0.002749
    0.002733
    0.002739
    0.00271
    0.002688
    0.002678
    0.002614
    0.002636
    0.002672
    0.00266
    0.002637
    0.002613
    0.002633
    0.002603
    0.002716
    0.002706
    0.002667
    0.002667
    0.002653
    0.002651
    0.002616
    0.002612
    0.002601
    0.002619
    0.002623
    0.002657
    0.002689
    0.002691
    0.002653
    0.002676
    0.002893
    0.002708
    0.002697
    0.002623
    0.002607
    0.002603
    0.00259
    0.002592
    0.00253
    0.002558
    0.002639
    0.002801
    0.002819
    0.002742
    0.002786
    0.002851
    0.002837
    0.002791
    0.002836
    0.002821
    0.002813
    0.003009
    0.002976
    0.002999
    0.00296
    0.003011
    0.003549
    0.00366
    0.003648
    0.004204
    0.004256
    0.003793
    0.003355
    0.00347
    0.00353
    0.00358
    0.003572
    0.003436
    0.0035
    0.003447
    0.003414
    0.003442
    0.0034
    0.003361
    0.003182
    0.003165
    0.00311
    0.003184
    0.003274
    0.003279
    0.00325
    0.003422
    0.004113
    0.00397
    0.004018
    0.004678
    0.005406
    0.004843
    0.004735
    0.004577
    0.004613
    0.00464
    0.004805
    0.004716
    0.004608
    0.004703
    0.004743
    0.005685
    0.013698
    0.013867
    0.011421
    0.010219
    0.010854
    0.010532
    0.010285
    0.01074
    0.010867
    0.009858
    0.009145
    0.008646
    0.01003
    0.009796
    0.009531
    0.009367
    0.009295
    0.009613
    0.009153
    0.009089
    0.008769
    0.008808
    0.008951
    0.008879
    0.008456
    0.008259
    0.013826
    0.077973
    0.049901
    0.045289
    0.04325
    0.034926
    0.039105
    0.057869
    0.05374
    0.058308
    0.084357
    0.084945
    0.083128
    0.081091
    0.074301
    0.07261
    0.071646
    0.066448
    0.063924
    0.059668
    0.054983
    0.061799
    0.059497
    0.060286
    0.058428
    0.060466
    0.053768
    0.059873
    0.057808
    0.052472
    0.05192
    0.050134
    0.051479
    0.052382
    0.052126
    0.051087
    0.050854
    0.052397
    0.052141
    0.061949
    0.062268
    0.058616
    0.056698
    0.05698
    0.062432
    0.063052
    0.059689
    0.058921
    0.058866
    0.058828
    0.059721
    0.060639
    0.059521
    0.057732
    0.056081
    0.056494
    0.052407
    0.054028
    0.055435
    0.054752
    0.054651
    0.055434
    0.054468
    0.070111
    0.062249
    0.059484
    0.058107
    0.060153
    0.06505
    0.067299
    0.061745
    0.06391
    0.065068
    0.079243
    0.074986
    0.095181
    0.14251
    0.187326
    0.4377
    0.374455
    0.349918
    0.431751
    0.422347
    0.343494
    ];

log2(size(DOGE))

plot(DOGE, 'linewidth', 1)
axis tight;
hold on
I = imread('doge.png');
h = image(xlim, ylim, I);
uistack(h, 'bottom')

plot(DOGE)
hold on;
DOGE_S_512 = coarsesplit(DOGE, SS);
plot(DOGE_S_512)
DOGE_S_256 = coarsesplit(DOGE_S_512, SS);
plot(DOGE_S_256)
DOGE_S_128 = coarsesplit(DOGE_S_256, SS);
plot(DOGE_S_128)
DOGE_S_64 = coarsesplit(DOGE_S_128, SS);
plot(DOGE_S_64)
DOGE_S_32 = coarsesplit(DOGE_S_64, SS);
plot(DOGE_S_32)
DOGE_S_16 = coarsesplit(DOGE_S_32, SS);
plot(DOGE_S_16)
DOGE_S_8 = coarsesplit(DOGE_S_16, SS);
plot(DOGE_S_8)
DOGE_S_4 = coarsesplit(DOGE_S_8, SS);
plot(DOGE_S_4)
DOGE_S_2 = coarsesplit(DOGE_S_4, SS);
plot(DOGE_S_2)
DOGE_S_0 = coarsesplit(DOGE_S_2, SS)


DOGE_D_512 = coarsesplit(DOGE, SD);
plot(DOGE_D_512)

hold on
DOGE_D_256 = coarsesplit(DOGE_S_512, SD);
plot(DOGE_D_256)
DOGE_D_128 = coarsesplit(DOGE_S_256, SD);
plot(DOGE_D_128)
DOGE_D_64 = coarsesplit(DOGE_S_128, SD);
plot(DOGE_D_64)
DOGE_D_32 = coarsesplit(DOGE_S_64, SD);
plot(DOGE_D_32)
DOGE_D_16 = coarsesplit(DOGE_S_32, SD);
plot(DOGE_D_16)
DOGE_D_8 = coarsesplit(DOGE_S_16, SD);
plot(DOGE_D_8)
DOGE_D_4 = coarsesplit(DOGE_S_8, SD);
plot(DOGE_D_4)
DOGE_D_2 = coarsesplit(DOGE_S_4, SD);
plot(DOGE_D_2)
axis tight;
I = imread('doge.png');
h = image(xlim, ylim, I);
uistack(h, 'bottom')
DOGE_D_0 = coarsesplit(DOGE_S_2, SD)
